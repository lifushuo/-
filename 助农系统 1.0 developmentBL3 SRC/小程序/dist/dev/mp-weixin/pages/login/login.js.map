{"version":3,"file":"login.js","sources":["../../../../../src/pages/login/login.vue","../../../../../uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onLoad } from '@dcloudio/uni-app'\nimport { postLoginWxMinAPI, postLoginWxMinSimpleAPI } from '@/services/login'\nimport { useMemberStore } from '@/stores'\nimport type { LoginResult } from '@/types/member'\n\nlet code = ''\n\n//获取 code 登录凭证\nonLoad(async () => {\n    const res = await wx.login()\n    code = res.code\n})\n\nconst onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) => {\n    const encryptedData = ev.detail.encryptedData!\n    const iv = ev.detail.iv!\n    const res = await postLoginWxMinAPI({\n        code,\n        encryptedData,\n        iv,\n    })\n    console.log(res)\n}\n\nconst loginSucess = (res: LoginResult) => {\n    uni.showToast({\n        title: '登录成功',\n    })\n    const memberStore = useMemberStore()\n    memberStore.setProfile(res)\n    setTimeout(() => {\n        // uni.switchTab({\n        //     url: '/pages/my/my',\n        // })\n        uni.navigateBack()\n    }, 500)\n}\n\n// 模拟手机号码快捷登录\nconst onGetphonenumberSimple = async () => {\n    const res = await postLoginWxMinSimpleAPI('18929796265')\n    // console.log(res)\n    loginSucess(res.result)\n}\n</script>\n\n<template>\n    <view class=\"viewport\">\n        <!--        <view class=\"logo\">-->\n        <!--            <image-->\n        <!--                src=\"https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/logo_icon.png\"-->\n        <!--            ></image>-->\n        <!--        </view>-->\n        <view class=\"login\">\n            <!-- 网页端表单登录 -->\n            <!-- <input class=\"input\" type=\"text\" placeholder=\"请输入用户名/手机号码\" /> -->\n            <!-- <input class=\"input\" type=\"text\" password placeholder=\"请输入密码\" /> -->\n            <!-- <button class=\"button phone\">登录</button> -->\n\n            <!-- 小程序端授权登录 -->\n            <button\n                style=\"margin-top: 120px\"\n                class=\"button phone\"\n                open-type=\"getPhoneNumber\"\n                @getphonenumber=\"onGetphonenumber\"\n            >\n                <text class=\"icon icon-phone\"></text>\n                手机号快捷登录\n            </button>\n            <view class=\"extra\">\n                <view class=\"caption\">\n                    <text>其他登录方式</text>\n                </view>\n                <view class=\"options\">\n                    <!-- 通用模拟登录 -->\n                    <button @tap=\"onGetphonenumberSimple\">\n                        <text class=\"icon icon-phone\">快捷登录</text>\n                    </button>\n                </view>\n            </view>\n            <!--            <view class=\"tips\">登录/注册即视为你同意《服务条款》和《小兔鲜儿隐私协议》</view>-->\n        </view>\n    </view>\n</template>\n\n<style lang=\"scss\">\npage {\n    height: 100%;\n}\n\n.viewport {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    padding: 20rpx 40rpx;\n}\n\n.logo {\n    flex: 1;\n    text-align: center;\n\n    image {\n        width: 220rpx;\n        height: 220rpx;\n        margin-top: 15vh;\n    }\n}\n\n.login {\n    display: flex;\n    flex-direction: column;\n    height: 60vh;\n    padding: 40rpx 20rpx 20rpx;\n\n    .input {\n        width: 100%;\n        height: 80rpx;\n        font-size: 28rpx;\n        border-radius: 72rpx;\n        border: 1px solid #ddd;\n        padding-left: 30rpx;\n        margin-bottom: 20rpx;\n    }\n\n    .button {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 100%;\n        height: 80rpx;\n        font-size: 28rpx;\n        border-radius: 72rpx;\n        color: #fff;\n\n        .icon {\n            font-size: 40rpx;\n            margin-right: 6rpx;\n        }\n    }\n\n    .phone {\n        background-color: #28bb9c;\n    }\n\n    .wechat {\n        background-color: #06c05f;\n    }\n\n    .extra {\n        flex: 1;\n        padding: 70rpx 70rpx 0;\n\n        .caption {\n            width: 440rpx;\n            line-height: 1;\n            border-top: 1rpx solid #ddd;\n            font-size: 26rpx;\n            color: #999;\n            position: relative;\n\n            text {\n                transform: translate(-40%);\n                background-color: #fff;\n                position: absolute;\n                top: -12rpx;\n                left: 50%;\n            }\n        }\n\n        .options {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            margin-top: 70rpx;\n\n            button {\n                padding: 0;\n                background-color: transparent;\n            }\n        }\n\n        .icon {\n            font-size: 24rpx;\n            color: #444;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n\n            &::before {\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                width: 80rpx;\n                height: 80rpx;\n                margin-bottom: 6rpx;\n                font-size: 40rpx;\n                border: 1rpx solid #444;\n                border-radius: 50%;\n            }\n        }\n\n        .icon-weixin::before {\n            border-color: #06c05f;\n            color: #06c05f;\n        }\n    }\n}\n\n.tips {\n    position: absolute;\n    bottom: 80rpx;\n    left: 20rpx;\n    right: 20rpx;\n    font-size: 22rpx;\n    color: #999;\n    text-align: center;\n}\n</style>\n","import MiniProgramPage from 'D:/OneDrive/桌面/uniapp小程序小兔/erabbit-uni-app-vue3-ts-master/src/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","wx","postLoginWxMinAPI","uni","useMemberStore","postLoginWxMinSimpleAPI"],"mappings":";;;;;;;;;AAMA,QAAI,OAAO;AAGXA,kBAAAA,OAAO,YAAY;AACT,YAAA,MAAM,MAAMC,mBAAG;AACrB,aAAO,IAAI;AAAA,IAAA,CACd;AAEK,UAAA,mBAAqD,OAAO,OAAO;AAC/D,YAAA,gBAAgB,GAAG,OAAO;AAC1B,YAAA,KAAK,GAAG,OAAO;AACf,YAAA,MAAM,MAAMC,iCAAkB;AAAA,QAChC;AAAA,QACA;AAAA,QACA;AAAA,MAAA,CACH;AACD,cAAQ,IAAI,GAAG;AAAA,IAAA;AAGb,UAAA,cAAc,CAAC,QAAqB;AACtCC,oBAAAA,MAAI,UAAU;AAAA,QACV,OAAO;AAAA,MAAA,CACV;AACD,YAAM,cAAcC,sBAAAA;AACpB,kBAAY,WAAW,GAAG;AAC1B,iBAAW,MAAM;AAIbD,sBAAA,MAAI,aAAa;AAAA,SAClB,GAAG;AAAA,IAAA;AAIV,UAAM,yBAAyB,YAAY;AACjC,YAAA,MAAM,MAAME,uCAAwB,aAAa;AAEvD,kBAAY,IAAI,MAAM;AAAA,IAAA;;;;;;;;;;AC1C1B,GAAG,WAAW,eAAe;"}